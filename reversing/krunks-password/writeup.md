# Krunks Password

## Authors

- @ItsIronicIInsist


## Category
- Reverse Engineering

## Description

We've found an alien on a rogue planet, seemingly guarding, well, not much at all. Calls itself Kronk, or Krunk, something like that. 
You've been entrusted with this, uh, veryyyy important diplomatic mission. Lightspeed!

## Difficulty

- Medium

## Points

50

## Files
- [krunks_password](./_ctfd/files/krunks_password): Challenge binary



## Solution

<details>
<summary>Spoiler</summary>

### Idea

Using GDB, bypass the password check, and then break when flag is finished loading into memory.

### Walkthrough

1. **Reading some assembly**
	- Open up the binary in GDB
	- Read through main
	- See a function called `loadFlag`
	- Locked behind a password check generated by `calculatePass`
	- `calculatePass` is an abomination
2. **Bypassing calculatePass**
	- Enter any input
	- Break on the `jne` after memcmp
	- Set the ZERO bit in eflags via `set $eflags |= 1<<6` (Coild also just change $rip's value)
	- Now we are taking the branch that will bring us into loadFlags
3. **loadFlag**
	- Also looks unnecessarily complicated
	- But as name suggets, probably loads flag into memory
	- Break at end of function
	- Rax and Rdi both seem to point to strings
	- `x/s $rdi -0x38` will give you the flag

### Flag

`BEGINNER{GDB_r3ally_d0_g0_brrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr}`

</details>
